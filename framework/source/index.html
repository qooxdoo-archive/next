<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>qxWeb source</title>
  <style type="text/css" media="screen">
  body > div {
    padding: 0 40px;
  }

  .hidden {
    display: none;
  }

  .red {
    color: red;
  }

  .underline {
    text-decoration: underline;
  }

  </style>
  <link rel="stylesheet" type="text/css" href="../build/resource/qx/css/indigo.css">
  <script type="text/javascript" src="script/q-source.js"></script>
  <script type="text/javascript">
    q.ready(function() {
      qx.module.Application.grayscale = function(data) {
        if (data) {
          var r = parseInt(data.substring(1, 3), 16);
          var g = parseInt(data.substring(3, 5), 16);
          var b = parseInt(data.substring(5, 7), 16);

          var val = ((Math.max(r, g, b) + Math.min(r, b, g)) / 2).toString(16);

          if (val.length == 1) {
            val = "0" + val;
          }

          data = "#" + val + val + val;
        }
        return data;
      };

      app = q(document.body).app();

      app.postfix = "!!!";
      app.test = qx.data.marshal.Json.createModel({name: "model value"});

      app.listModel = new qx.data.Array(["a", "b", "c"]);

      // JSON loading
      var store = new qx.data.store.Json("resource/qx/test/primitive.json");
      app.addModel("primitive", null),
      qx.data.SingleValueBinding.bind(store, "model", app, "primitive");


      // TODO
      // - binding of {{list[0]}}
      // - events
    });
  </script>
</head>
<body>

  <div>
    <h3 data-bind="class -> underline {{classname}}">Class name from model</h3>
    <input data-bind="value -> {{classname}}" placeholder="e.g. red">
  </div>

  <div>
    <h3>Repeat</h3>
    <ul data-repeat="{{listModel}}">
      <li data-bind="html -> {{listModel[$index]}}; style.color -> {{mycolor}}"></li>
    </ul>
  </div>

  <div>
    <h3>Not</h3>
    <input type="checkbox" data-bind="checked -> {{x}}">
    <span data-bind="html -> {{x}}"></span> !=
    <span data-bind="html -> {{not(x)}}"></span>
  </div>

  <div>
    <h3>Only app code required</h3>
    <input
      data-bind="value -> {{mycolor}};
                 style.color -> {{mycolor}};
                 style.font-size -> {{slider}}px;"
      value="red"
      placeholder="type in text color">
  </div>

  <div>
    <h3>Bidirectional binding</h3>
    <input data-bind="value -> {{test.name}}">
    <span data-bind="html -> {{test.name}}{{postfix}}"></span>
  </div>


  <div>
    <h3>Show / Hide / Enabled</h3>
    <label>hide <input type="checkbox" data-bind="checked -> {{hidden}}"></label>
    <label>disabled <input type="checkbox" data-bind="checked -> {{enabled}}"></label>
    <input type="text" data-bind="class.hidden -> {{hidden}}; disabled -> {{enabled}}" value="test">
  </div>


  <div>
    <h3>Select</h3>
    <select data-repeat="{{listModel}}" data-bind="value -> {{selected}}">
      <option data-bind="html -> {{listModel[$index]}};">AFFE</option>
    </select>
    <span data-bind="html -> Selected: {{selected}}"></span>
  </div>


  <div>
    <h3>Widget Binding</h3>
    <div data-qx-widget="qx.ui.form.Slider"
      data-bind="data-qx-config-value -> {{slider}}"
      data-qx-config-value="22"></div>
    <p data-bind="html -> The slider value is {{slider}}.; class.hidden -> {{slider}}"></p>
    <div
      data-qx-widget="qx.ui.List"
      data-bind="data-qx-config-model -> {{listModel}}"></div>
    <p data-bind="class.hidden -> {{not(listModel.length)}}"># <span data-bind="html -> {{listModel.length}}"></span> Items in the list</p>
  </div>

  <div>
    <h3>Load via Json Store</h3>
    <p data-bind="html -> {{primitive.string}}"></p>
    <p data-bind="html -> {{primitive.number}}"></p>
    <p data-bind="html -> {{primitive.boolean}}"></p>
  </div>


  <div>
    <h3 data-bind="style.color -> {{grayscale(customColor)}}">Color to grayscale</h3>
    <input type="color" data-bind="value -> {{customColor}}">
  </div>

</body>
</html>